# yaml-language-server: $schema=https://raw.githubusercontent.com/Azure/azure-dev/main/schemas/v1.0/azure.yaml.json

name: foundry-hosted-agent
metadata:
    template: azd-ai-foundry-hosted-agent
services:
    my-hosted-agent:
        project: src/my-hosted-agent
        host: azure.ai.agent
        language: docker
        docker:
            remoteBuild: true
        config:
            container:
                resources:
                    cpu: "1"
                    memory: 2Gi
                scale:
                    maxReplicas: 3
                    minReplicas: 1
infra:
    provider: bicep
    path: ./infra
hooks:
    postdeploy:
        shell: sh
        run: |
            echo ""
            echo "=========================================="
            echo "Hosted agent deployed successfully!"
            echo "=========================================="
            echo ""
            echo "To invoke your agent, use the Foundry SDK or Portal."
            echo ""
    predeploy:
        shell: sh
        run: |
            echo "Validating agent configuration..."
            if [ ! -f "./hosted_agent_app/agent.yaml" ]; then
              echo "Error: agent.yaml not found"
              exit 1
            fi
            echo "Validation passed."
